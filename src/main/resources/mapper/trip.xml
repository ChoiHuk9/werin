<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="trip">
	<insert id="create" parameterType="tripVO">
		insert into trip values
		(#{trip_id},#{trip_title},#{trip_content},#{trip_start_date},#{trip_end_date},
		#{trip_writer}, now(), 0,0,#{trip_img})
	</insert>

	<update id="update" parameterType="tripVO">
		update trip set trip_title =
		#{trip_title}, trip_content = #{trip_content} where trip_id =
		#{trip_id}
	</update>

	<update id="viewCount" parameterType="int">
		update trip 
		set trip_count = trip_count + 1 
		where trip_id = #{trip_id}
	</update>
	
	<update id = "updateLike" parameterType="int">
		update trip 
		set trip_total_like = trip_total_like + 1 
		where trip_id = #{trip_id}
	</update>
	
	<update id = "updateDislike" parameterType="int">
		update trip 
		set trip_total_like = trip_total_like - 1 
		where trip_id = #{trip_id}
	</update>

	<delete id="delete" parameterType="tripVO">
		delete from trip where
		trip_id
		= #{trip_id}
	</delete>

	<select id="one" parameterType="tripVO" resultType="tripVO">
		SELECT * FROM
		trip WHERE trip_id = #{trip_id};
	</select>

	<!-- <select id="list" resultType="tripVO">
		select * from trip order by trip_id
		desc
	</select> -->
	
	<select id="list" parameterType="pageVO" resultType="tripVO">
		select *
		from (select row_number() over(order by trip_id desc)
		as row_no, trip_id, trip_title, trip_content, trip_start_date,
		trip_end_date, trip_writer, trip_writedate, trip_count, trip_total_like,
		trip_img
		from trip t) t2
		where t2.row_no BETWEEN ${start} and ${end}
	</select>

	<select id="count" resultType="int">
		select count(*) from trip
	</select>
</mapper>
